<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ–î–æ–∫ ‚Äî –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <a href="/" class="logo">
            <span class="logo-icon">üìÑ</span>
            <span class="logo-text">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ–î–æ–∫</span>
            <span class="logo-badge">–ü—Ä–æ</span>
        </a>
        <div class="nav-menu">
            <a href="#compare" class="nav-link active" data-view="compare">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ</a>
            <a href="#merge" class="nav-link" data-view="merge">–°–ª–∏—è–Ω–∏–µ</a>
        </div>
        <div class="nav-right">
            <a href="/docs" target="_blank" class="btn btn-outline">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>
        </div>
    </nav>

    <!-- Compare Section -->
    <section class="section" id="compare">
        <div class="section-header">
            <h2 class="section-title">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2>
        </div>

        <!-- Upload Zone -->
        <div class="upload-zone" id="uploadZone">
            <div class="upload-icon">üìÅ</div>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
            <span class="upload-formats">PDF, DOCX, TXT ‚Ä¢ –¥–æ 50 –ú–ë</span>
            <input type="file" id="fileInput" multiple accept=".pdf,.docx,.txt" hidden>
            <button class="btn btn-outline" onclick="document.getElementById('fileInput').click()">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã</button>
        </div>

        <!-- Documents List -->
        <div class="docs-list-compact" id="docsListCompact">
            <div class="docs-header">
                <span>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</span>
                <span class="doc-count" id="docCount">0 —Ñ–∞–π–ª–æ–≤</span>
            </div>
            <div class="docs-items" id="docsItems"></div>
        </div>

        <div class="compare-panel">
            <div class="compare-selectors">
                <div class="selector-box">
                    <label>–î–æ–∫—É–º–µ–Ω—Ç 1 (–û—Ä–∏–≥–∏–Ω–∞–ª)</label>
                    <select id="doc1Select" class="select-input">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç</option>
                    </select>
                </div>
                <div class="vs-divider">‚áã</div>
                <div class="selector-box">
                    <label>–î–æ–∫—É–º–µ–Ω—Ç 2 (–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π)</label>
                    <select id="doc2Select" class="select-input">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç</option>
                    </select>
                </div>
            </div>

            <div class="modes-section">
                <label>–†–µ–∂–∏–º —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</label>
                <div class="modes-grid modes-grid-2">
                    <button class="mode-btn active" data-mode="line-by-line">
                        <span class="mode-icon">üìù</span>
                        <span class="mode-name">–ü–æ—Å—Ç—Ä–æ—á–Ω–æ</span>
                        <span class="mode-desc">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ</span>
                    </button>
                    <button class="mode-btn" data-mode="semantic">
                        <span class="mode-icon">üß†</span>
                        <span class="mode-name">–°–µ–º–∞–Ω—Ç–∏–∫–∞ + AI</span>
                        <span class="mode-desc">–ê–Ω–∞–ª–∏–∑ —Å–º—ã—Å–ª–∞</span>
                    </button>
                </div>
            </div>

            <div class="ai-prompt-section hidden" id="aiPromptSection">
                <label for="customPrompt">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ AI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <textarea id="customPrompt" class="ai-prompt-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö' –∏–ª–∏ '–û—Ü–µ–Ω–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏'" rows="2"></textarea>
            </div>

            <div class="compare-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="showFullDocument">
                    <span class="checkmark"></span>
                    –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
                </label>
            </div>

            <button class="btn btn-primary btn-large" id="compareBtn" onclick="runComparison()">
                –°—Ä–∞–≤–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
            </button>

            <!-- Inline Progress & Logs for Compare -->
            <div class="inline-progress hidden" id="compareProgress">
                <div class="progress-header-inline">
                    <span class="progress-title-inline">–û–±—Ä–∞–±–æ—Ç–∫–∞...</span>
                    <span class="progress-percent-inline">0%</span>
                </div>
                <div class="progress-bar-inline">
                    <div class="progress-fill-inline"></div>
                </div>
                <div class="log-section">
                    <div class="log-section-header" onclick="toggleLogSection('compareProgress')">
                        <span class="log-section-title">
                            üìã –ñ—É—Ä–Ω–∞–ª –æ–ø–µ—Ä–∞—Ü–∏–π
                            <span class="log-count">0 –∑–∞–ø–∏—Å–µ–π</span>
                        </span>
                        <span class="log-toggle-icon">‚ñº</span>
                    </div>
                    <div class="inline-log"></div>
                </div>
            </div>
        </div>

        <!-- Results Panel -->
        <div class="results-panel hidden" id="resultsPanel">
            <div class="results-header">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</h3>
                <div class="results-stats">
                    <div class="stat"><span class="stat-value" id="totalChanges">0</span><span class="stat-label">–ò–∑–º–µ–Ω–µ–Ω–∏–π</span></div>
                    <div class="stat critical"><span class="stat-value" id="criticalChanges">0</span><span class="stat-label">üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã—Ö</span></div>
                    <div class="stat major"><span class="stat-value" id="majorChanges">0</span><span class="stat-label">üü° –í–∞–∂–Ω—ã—Ö</span></div>
                    <div class="stat minor"><span class="stat-value" id="minorChanges">0</span><span class="stat-label">üü¢ –ú–µ–ª–∫–∏—Ö</span></div>
                    <div class="stat"><span class="stat-value" id="similarity">0%</span><span class="stat-label">–°—Ö–æ–∂–µ—Å—Ç—å</span></div>
                </div>
            </div>

            <div class="mode-info hidden" id="modeInfo"></div>

            <div class="ai-summary-section hidden" id="aiSummarySection">
                <div class="ai-summary-header">
                    <span class="ai-icon">üß†</span>
                    <h4>–†–µ–∑—é–º–µ –æ—Ç AI</h4>
                    <span class="ai-badge" id="aiBadge">GPT</span>
                </div>
                <div class="ai-summary-content" id="aiSummaryContent"></div>
            </div>

            <div class="diff-container" id="diffContainer">
                <div class="diff-header">
                    <div class="diff-title-left">
                        <span class="diff-label">üìÑ –û—Ä–∏–≥–∏–Ω–∞–ª</span>
                        <span class="diff-filename" id="diffFilename1">‚Äî</span>
                    </div>
                    <div class="diff-title-right">
                        <span class="diff-label">üìÑ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π</span>
                        <span class="diff-filename" id="diffFilename2">‚Äî</span>
                    </div>
                </div>
                <div class="diff-table-wrapper">
                    <table class="diff-table" id="diffTable">
                        <tbody id="diffBody"></tbody>
                    </table>
                </div>
            </div>

            <div class="diff-legend">
                <span class="legend-item"><span class="legend-color deleted"></span> –£–¥–∞–ª–µ–Ω–æ</span>
                <span class="legend-item"><span class="legend-color added"></span> –î–æ–±–∞–≤–ª–µ–Ω–æ</span>
                <span class="legend-item"><span class="legend-color modified"></span> –ò–∑–º–µ–Ω–µ–Ω–æ</span>
                <span class="legend-item"><span class="legend-color unchanged"></span> –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π</span>
            </div>
        </div>
    </section>

    <!-- Merge Section -->
    <section class="section hidden" id="merge">
        <div class="section-header">
            <h2 class="section-title">–°–ª–∏—è–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2>
        </div>

        <!-- Upload Zone for Merge -->
        <div class="upload-zone" id="uploadZoneMerge">
            <div class="upload-icon">üìÅ</div>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
            <span class="upload-formats">PDF, DOCX, TXT ‚Ä¢ –¥–æ 50 –ú–ë</span>
            <input type="file" id="fileInputMerge" multiple accept=".pdf,.docx,.txt" hidden>
            <button class="btn btn-outline" onclick="document.getElementById('fileInputMerge').click()">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã</button>
        </div>

        <div class="merge-panel">
            <div class="merge-docs-selector">
                <label>–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–ª–∏—è–Ω–∏—è (2-10)</label>
                <div class="merge-docs-list" id="mergeDocsList"></div>
            </div>

            <div class="merge-strategy">
                <label>–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–ª–∏—è–Ω–∏—è</label>
                <div class="strategy-options">
                    <button class="strategy-btn active" data-strategy="MOST_RECENT">
                        <span class="strategy-icon">üïê</span>
                        <span class="strategy-name">–°–∞–º–∞—è –Ω–æ–≤–∞—è</span>
                        <span class="strategy-desc">–ü–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</span>
                    </button>
                    <button class="strategy-btn" data-strategy="MANUAL">
                        <span class="strategy-icon">‚úã</span>
                        <span class="strategy-name">–í—Ä—É—á–Ω—É—é</span>
                        <span class="strategy-desc">–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤</span>
                    </button>
                </div>
            </div>

            <button class="btn btn-primary btn-large" onclick="startMerge()">–ù–∞—á–∞—Ç—å —Å–ª–∏—è–Ω–∏–µ</button>

            <!-- Inline Progress & Logs for Merge -->
            <div class="inline-progress hidden" id="mergeProgress">
                <div class="progress-header-inline">
                    <span class="progress-title-inline">–û–±—Ä–∞–±–æ—Ç–∫–∞...</span>
                    <span class="progress-percent-inline">0%</span>
                </div>
                <div class="progress-bar-inline">
                    <div class="progress-fill-inline"></div>
                </div>
                <div class="log-section">
                    <div class="log-section-header" onclick="toggleLogSection('mergeProgress')">
                        <span class="log-section-title">
                            üìã –ñ—É—Ä–Ω–∞–ª –æ–ø–µ—Ä–∞—Ü–∏–π
                            <span class="log-count">0 –∑–∞–ø–∏—Å–µ–π</span>
                        </span>
                        <span class="log-toggle-icon">‚ñº</span>
                    </div>
                    <div class="inline-log"></div>
                </div>
            </div>
        </div>

        <!-- Merge Results -->
        <div class="merge-results hidden" id="mergeResults">
            <div class="merge-header">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–ª–∏—è–Ω–∏—è</h3>
                <div class="merge-stats">
                    <span class="merge-stat"><strong id="mergeConflicts">0</strong> –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤</span>
                    <span class="merge-stat success"><strong id="mergeAutoResolved">0</strong> –ê–≤—Ç–æ-—Ä–∞–∑—Ä–µ—à–µ–Ω–æ</span>
                </div>
            </div>

            <div class="conflicts-list" id="conflictsList"></div>

            <div class="merge-actions">
                <button class="btn btn-outline" onclick="cancelMerge()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                <button class="btn btn-primary" id="finalizeMergeBtn" onclick="finalizeMerge()">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–ª–∏—è–Ω–∏–µ</button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <span class="logo-icon">üìÑ</span> –°—Ä–∞–≤–Ω–µ–Ω–∏–µ–î–æ–∫ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
            </div>
            <div class="footer-links">
                <a href="/docs" target="_blank">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>
                <a href="/api/v1/health" target="_blank">–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</a>
            </div>
        </div>
    </footer>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="app.js"></script>
</body>

</html>
