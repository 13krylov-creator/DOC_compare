<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose', // Allow inline styles
            flowchart: { useMaxWidth: false, htmlLabels: true }
        });
    </script>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <a href="/" class="logo">
            <span class="logo-icon">üìÑ</span>
            <span class="logo-text">–î–æ–∫—É–º–µ–Ω—Ç—ã</span>
            <span class="logo-badge">–ü—Ä–æ</span>
        </a>
        <div class="nav-menu">
            <a href="#compare" class="nav-link active" data-view="compare">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ</a>
            <a href="#merge" class="nav-link" data-view="merge">–°–ª–∏—è–Ω–∏–µ</a>
            <a href="#anonymize" class="nav-link" data-view="anonymize">–û–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏–µ</a>
            <a href="#docanalysis" class="nav-link" data-view="docanalysis">–ê–Ω–∞–ª–∏–∑</a>
        </div>
        <div class="nav-right">
            <div class="anon-ml-status" style="margin-right: 20px;">
                <span class="anon-status-dot" id="gptStatusAnon" title="GPT">GPT</span>
                <span class="anon-status-dot" id="visionStatusAnon" title="Vision">Vision</span>
            </div>
            <div class="user-info" id="userInfo">
                <span class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                <button class="btn btn-outline btn-sm" onclick="logout()">–í—ã—Ö–æ–¥</button>
            </div>
        </div>
    </nav>

    <!-- Compare Section -->
    <section class="section" id="compare">
        <div class="section-header">
            <h2 class="section-title">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2>
        </div>

        <!-- Upload Zone -->
        <div class="upload-zone" id="uploadZone">
            <div class="upload-icon">üìÅ</div>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
            <span class="upload-formats">PDF, DOCX, TXT ‚Ä¢ –¥–æ 50 –ú–ë</span>
            <span class="upload-retention">‚è±Ô∏è –§–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è 7 –¥–Ω–µ–π</span>
            <input type="file" id="fileInput" multiple accept=".pdf,.docx,.txt" hidden>
            <button class="btn btn-outline" onclick="document.getElementById('fileInput').click()">–í—ã–±—Ä–∞—Ç—å
                —Ñ–∞–π–ª—ã</button>
        </div>

        <!-- Documents List -->
        <div class="docs-list-compact" id="docsListCompact">
            <div class="docs-header">
                <span>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</span>
                <span class="doc-count" id="docCount">0 —Ñ–∞–π–ª–æ–≤</span>
            </div>
            <div class="docs-items" id="docsItems"></div>
        </div>

        <div class="compare-panel">
            <div class="compare-selectors">
                <div class="selector-box">
                    <label>–î–æ–∫—É–º–µ–Ω—Ç 1 (–û—Ä–∏–≥–∏–Ω–∞–ª)</label>
                    <select id="doc1Select" class="select-input">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç</option>
                    </select>
                </div>
                <div class="vs-divider">‚áã</div>
                <div class="selector-box">
                    <label>–î–æ–∫—É–º–µ–Ω—Ç 2 (–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π)</label>
                    <select id="doc2Select" class="select-input">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç</option>
                    </select>
                </div>
            </div>

            <div class="modes-section">
                <label>–†–µ–∂–∏–º —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</label>
                <div class="modes-grid modes-grid-2">
                    <button class="mode-btn active" data-mode="line-by-line">
                        <span class="mode-icon">üìù</span>
                        <span class="mode-name">–ü–æ—Å—Ç—Ä–æ—á–Ω–æ</span>
                        <span class="mode-desc">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ</span>
                    </button>
                    <button class="mode-btn" data-mode="semantic">
                        <span class="mode-icon">üß†</span>
                        <span class="mode-name">–°–µ–º–∞–Ω—Ç–∏–∫–∞ + AI</span>
                        <span class="mode-desc">–ê–Ω–∞–ª–∏–∑ —Å–º—ã—Å–ª–∞</span>
                    </button>
                </div>
            </div>

            <div class="ai-prompt-section hidden" id="aiPromptSection">
                <label for="customPrompt">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ AI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <textarea id="customPrompt" class="ai-prompt-input"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö' –∏–ª–∏ '–û—Ü–µ–Ω–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏'"
                    rows="2"></textarea>
            </div>

            <div class="compare-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="showFullDocument">
                    <span class="checkmark"></span>
                    –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
                </label>
            </div>

            <button class="btn btn-primary btn-large" id="compareBtn" onclick="runComparison()">
                –°—Ä–∞–≤–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
            </button>

            <!-- Inline Progress & Logs for Compare -->
            <div class="inline-progress hidden" id="compareProgress">
                <div class="progress-header-inline">
                    <span class="progress-title-inline">–û–±—Ä–∞–±–æ—Ç–∫–∞...</span>
                    <span class="progress-percent-inline">0%</span>
                </div>
                <div class="progress-bar-inline">
                    <div class="progress-fill-inline"></div>
                </div>
                <div class="log-section">
                    <div class="log-section-header" onclick="toggleLogSection('compareProgress')">
                        <span class="log-section-title">
                            üìã –ñ—É—Ä–Ω–∞–ª –æ–ø–µ—Ä–∞—Ü–∏–π
                            <span class="log-count">0 –∑–∞–ø–∏—Å–µ–π</span>
                        </span>
                        <span class="log-toggle-icon">‚ñº</span>
                    </div>
                    <div class="inline-log"></div>
                </div>
            </div>
        </div>

        <!-- Results Panel -->
        <div class="results-panel hidden" id="resultsPanel">
            <div class="results-header">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</h3>
                <div class="results-stats">
                    <div class="stat"><span class="stat-value" id="totalChanges">0</span><span
                            class="stat-label">–ò–∑–º–µ–Ω–µ–Ω–∏–π</span></div>
                    <div class="stat critical"><span class="stat-value" id="criticalChanges">0</span><span
                            class="stat-label">üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã—Ö</span></div>
                    <div class="stat major"><span class="stat-value" id="majorChanges">0</span><span
                            class="stat-label">üü° –í–∞–∂–Ω—ã—Ö</span></div>
                    <div class="stat minor"><span class="stat-value" id="minorChanges">0</span><span
                            class="stat-label">üü¢ –ú–µ–ª–∫–∏—Ö</span></div>
                    <div class="stat"><span class="stat-value" id="similarity">0%</span><span
                            class="stat-label">–°—Ö–æ–∂–µ—Å—Ç—å</span></div>
                </div>
            </div>

            <div class="mode-info hidden" id="modeInfo"></div>

            <div class="ai-summary-section hidden" id="aiSummarySection">
                <div class="ai-summary-header">
                    <span class="ai-icon">üß†</span>
                    <h4>–†–µ–∑—é–º–µ –æ—Ç AI</h4>
                    <span class="ai-badge" id="aiBadge">GPT</span>
                </div>
                <div class="ai-summary-content" id="aiSummaryContent"></div>
            </div>

            <div class="diff-container" id="diffContainer">
                <div class="diff-header">
                    <div class="diff-title-left">
                        <span class="diff-label">üìÑ –û—Ä–∏–≥–∏–Ω–∞–ª</span>
                        <span class="diff-filename" id="diffFilename1">‚Äî</span>
                    </div>
                    <div class="diff-title-right">
                        <span class="diff-label">üìÑ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π</span>
                        <span class="diff-filename" id="diffFilename2">‚Äî</span>
                    </div>
                </div>
                <div class="diff-table-wrapper">
                    <table class="diff-table" id="diffTable">
                        <tbody id="diffBody"></tbody>
                    </table>
                </div>
            </div>

            <div class="diff-legend">
                <span class="legend-item"><span class="legend-color deleted"></span> –£–¥–∞–ª–µ–Ω–æ</span>
                <span class="legend-item"><span class="legend-color added"></span> –î–æ–±–∞–≤–ª–µ–Ω–æ</span>
                <span class="legend-item"><span class="legend-color modified"></span> –ò–∑–º–µ–Ω–µ–Ω–æ</span>
                <span class="legend-item"><span class="legend-color unchanged"></span> –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π</span>
            </div>
        </div>
    </section>

    <!-- Merge Section -->
    <section class="section hidden" id="merge">
        <div class="section-header">
            <h2 class="section-title">–°–ª–∏—è–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2>
        </div>

        <!-- Upload Zone for Merge -->
        <div class="upload-zone" id="uploadZoneMerge">
            <div class="upload-icon">üìÅ</div>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
            <span class="upload-formats">PDF, DOCX, TXT ‚Ä¢ –¥–æ 50 –ú–ë</span>
            <span class="upload-retention">‚è±Ô∏è –§–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è 7 –¥–Ω–µ–π</span>
            <input type="file" id="fileInputMerge" multiple accept=".pdf,.docx,.txt" hidden>
            <button class="btn btn-outline" onclick="document.getElementById('fileInputMerge').click()">–í—ã–±—Ä–∞—Ç—å
                —Ñ–∞–π–ª—ã</button>
        </div>

        <div class="merge-panel">
            <div class="merge-docs-selector">
                <label>–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–ª–∏—è–Ω–∏—è (2-10)</label>
                <div class="merge-docs-list" id="mergeDocsList"></div>
            </div>

            <div class="merge-strategy">
                <label>–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–ª–∏—è–Ω–∏—è</label>
                <div class="strategy-options">
                    <button class="strategy-btn active" data-strategy="MOST_RECENT">
                        <span class="strategy-icon">üïê</span>
                        <span class="strategy-name">–°–∞–º–∞—è –Ω–æ–≤–∞—è</span>
                        <span class="strategy-desc">–ü–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</span>
                    </button>
                    <button class="strategy-btn" data-strategy="MANUAL">
                        <span class="strategy-icon">‚úã</span>
                        <span class="strategy-name">–í—Ä—É—á–Ω—É—é</span>
                        <span class="strategy-desc">–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤</span>
                    </button>
                </div>
            </div>

            <button class="btn btn-primary btn-large" onclick="startMerge()">–ù–∞—á–∞—Ç—å —Å–ª–∏—è–Ω–∏–µ</button>

            <!-- Inline Progress & Logs for Merge -->
            <div class="inline-progress hidden" id="mergeProgress">
                <div class="progress-header-inline">
                    <span class="progress-title-inline">–û–±—Ä–∞–±–æ—Ç–∫–∞...</span>
                    <span class="progress-percent-inline">0%</span>
                </div>
                <div class="progress-bar-inline">
                    <div class="progress-fill-inline"></div>
                </div>
                <div class="log-section">
                    <div class="log-section-header" onclick="toggleLogSection('mergeProgress')">
                        <span class="log-section-title">
                            üìã –ñ—É—Ä–Ω–∞–ª –æ–ø–µ—Ä–∞—Ü–∏–π
                            <span class="log-count">0 –∑–∞–ø–∏—Å–µ–π</span>
                        </span>
                        <span class="log-toggle-icon">‚ñº</span>
                    </div>
                    <div class="inline-log"></div>
                </div>
            </div>
        </div>

        <!-- Merge Results -->
        <div class="merge-results hidden" id="mergeResults">
            <div class="merge-header">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–ª–∏—è–Ω–∏—è</h3>
                <div class="merge-stats">
                    <span class="merge-stat"><strong id="mergeConflicts">0</strong> –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤</span>
                    <span class="merge-stat success"><strong id="mergeAutoResolved">0</strong> –ê–≤—Ç–æ-—Ä–∞–∑—Ä–µ—à–µ–Ω–æ</span>
                </div>
            </div>

            <div class="conflicts-list" id="conflictsList"></div>

            <div class="merge-actions">
                <button class="btn btn-outline" onclick="cancelMerge()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                <button class="btn btn-primary" id="finalizeMergeBtn" onclick="finalizeMerge()">–ó–∞–≤–µ—Ä—à–∏—Ç—å
                    —Å–ª–∏—è–Ω–∏–µ</button>
            </div>
        </div>
    </section>

    <!-- Anonymize Section -->
    <section class="section hidden" id="anonymize">
        <div class="section-header">
            <h2 class="section-title">–û–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2>
        </div>

        <!-- Upload Zone for Anonymizer -->
        <div class="anon-upload-zone" id="uploadZoneAnon">
            <div class="upload-icon">üîí</div>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏—è</h3>
            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
            <span class="upload-formats">DOCX, XLSX, XLS, PDF ‚Ä¢ –¥–æ 50 –ú–ë</span>
            <input type="file" id="fileInputAnon" accept=".docx,.xlsx,.xls,.pdf" hidden>
            <button class="btn btn-outline" onclick="document.getElementById('fileInputAnon').click()">–í—ã–±—Ä–∞—Ç—å
                —Ñ–∞–π–ª</button>
        </div>

        <!-- File Info -->
        <div class="anon-file-info" id="fileInfoAnon" style="display: none;">
            <div class="anon-file-icon">üìÑ</div>
            <div class="anon-file-details">
                <span class="anon-file-name" id="fileNameAnon"></span>
                <span class="anon-file-size" id="fileSizeAnon"></span>
            </div>
            <button class="btn btn-outline btn-sm" id="removeFileAnon">‚úï</button>
        </div>

        <!-- Settings -->
        <div class="anon-settings" id="anonSettings">
            <div class="anon-settings-header">
                <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏—è</h3>
                <div class="anon-profile-selector">
                    <select id="profileSelectAnon" class="select-input">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å...</option>
                        <option value="full">–ü–æ–ª–Ω–æ–µ –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏–µ</option>
                        <option value="media">–î–ª—è –°–ú–ò</option>
                        <option value="partners">–î–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤</option>
                    </select>
                </div>
            </div>

            <div class="anon-options-grid">
                <label class="anon-option-card" data-option="prices">
                    <input type="checkbox" name="anonOption" value="prices">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üí∞ –¶–µ–Ω—ã –∏ —Å—É–º–º—ã</span>
                        <span class="anon-option-desc">–ó–∞–º–µ–Ω–∞ –¥–µ–Ω–µ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="companies">
                    <input type="checkbox" name="anonOption" value="companies">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üè¢ –ù–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–π</span>
                        <span class="anon-option-desc">–ó–∞–º–µ–Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="logos">
                    <input type="checkbox" name="anonOption" value="logos">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üñºÔ∏è –õ–æ–≥–æ—Ç–∏–ø—ã</span>
                        <span class="anon-option-desc">–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ª–æ–≥–æ—Ç–∏–ø–æ–≤</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="personal">
                    <input type="checkbox" name="anonOption" value="personal">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üë§ –§–ò–û –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã</span>
                        <span class="anon-option-desc">–ó–∞–º–µ–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="addresses">
                    <input type="checkbox" name="anonOption" value="addresses">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üìç –ê–¥—Ä–µ—Å–∞ –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è</span>
                        <span class="anon-option-desc">–£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∞–¥—Ä–µ—Å–æ–≤</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="requisites">
                    <input type="checkbox" name="anonOption" value="requisites">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üèõÔ∏è –†–µ–∫–≤–∏–∑–∏—Ç—ã</span>
                        <span class="anon-option-desc">–£–¥–∞–ª–µ–Ω–∏–µ –ò–ù–ù, –û–ì–†–ù, —Å—á–µ—Ç–æ–≤</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="dates">
                    <input type="checkbox" name="anonOption" value="dates">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üìÖ –î–∞—Ç—ã –∏ —Å—Ä–æ–∫–∏</span>
                        <span class="anon-option-desc">–ó–∞–º–µ–Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –¥–∞—Ç</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="technical">
                    <input type="checkbox" name="anonOption" value="technical">
                    <div class="anon-option-content">
                        <span class="anon-option-label">‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏</span>
                        <span class="anon-option-desc">–ó–∞–º–µ–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –≤–µ—Ä—Å–∏–π</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="metadata">
                    <input type="checkbox" name="anonOption" value="metadata">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üìã –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤</span>
                        <span class="anon-option-desc">–û—á–∏—Å—Ç–∫–∞ —Å–ª—É–∂–µ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</span>
                    </div>
                </label>
                <label class="anon-option-card" data-option="watermarks">
                    <input type="checkbox" name="anonOption" value="watermarks">
                    <div class="anon-option-content">
                        <span class="anon-option-label">üíß –í–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏</span>
                        <span class="anon-option-desc">–£–¥–∞–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤</span>
                    </div>
                </label>
            </div>

            <div class="anon-settings-actions">
                <button class="btn btn-outline btn-sm" id="selectAllAnon">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
                <button class="btn btn-outline btn-sm" id="clearAllAnon">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ</button>
            </div>
        </div>

        <!-- Process Button -->
        <button class="btn btn-primary btn-large" id="processBtnAnon" disabled>üîí –û–±–µ–∑–ª–∏—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</button>

        <!-- Progress Section -->
        <div class="inline-progress hidden" id="progressSectionAnon">
            <div class="progress-header-inline">
                <span class="progress-title-inline" id="progressStatusAnon">–û–±—Ä–∞–±–æ—Ç–∫–∞...</span>
                <span class="progress-percent-inline" id="progressPercentAnon">0%</span>
            </div>
            <div class="progress-bar-inline">
                <div class="progress-fill-inline" id="progressFillAnon"></div>
            </div>
            <div class="anon-progress-message" id="progressMessageAnon"></div>
            <div class="anon-process-logs" id="processLogsAnon">
                <h4>üìã –ñ—É—Ä–Ω–∞–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏:</h4>
                <div class="anon-logs-content" id="logsContentAnon"></div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="anon-results hidden" id="resultsSectionAnon">
            <div class="anon-results-header">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏—è</h3>
                <div class="anon-validation-badge" id="validationBadgeAnon"></div>
            </div>
            <div class="anon-results-stats">
                <div class="stat"><span class="stat-value" id="replacementsCountAnon">0</span><span
                        class="stat-label">–ó–∞–º–µ–Ω</span></div>
                <div class="stat"><span class="stat-value" id="confidenceValueAnon">0%</span><span
                        class="stat-label">–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</span></div>
            </div>
            <div class="anon-validation-issues" id="validationIssuesAnon" style="display: none;">
                <details>
                    <summary>‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã</summary>
                    <ul id="issuesListAnon"></ul>
                </details>
            </div>
            <div class="anon-results-actions">
                <button class="btn btn-primary" id="downloadBtnAnon">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</button>
                <button class="btn btn-primary" id="downloadPdfBtnAnon" style="display: none;">üìÑ –°–∫–∞—á–∞—Ç—å PDF</button>
                <button class="btn btn-outline" id="viewBtnAnon">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                <button class="btn btn-outline" id="previewBtnAnon">üîç –°—Ä–∞–≤–Ω–µ–Ω–∏–µ</button>
                <button class="btn btn-outline" id="mappingBtnAnon">üìã –ñ—É—Ä–Ω–∞–ª –∑–∞–º–µ–Ω</button>
            </div>
        </div>

        <!-- Preview Modal -->
        <div class="anon-preview-modal" id="previewModalAnon">
            <div class="modal-backdrop"></div>
            <div class="anon-modal-content">
                <div class="anon-modal-header">
                    <h3>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –¥–æ –∏ –ø–æ—Å–ª–µ</h3>
                    <button class="btn btn-outline btn-sm" id="closePreviewAnon">‚úï</button>
                </div>
                <div class="anon-modal-body">
                    <div class="anon-preview-col">
                        <h4>–û—Ä–∏–≥–∏–Ω–∞–ª</h4>
                        <pre id="originalPreviewAnon"></pre>
                    </div>
                    <div class="anon-preview-col">
                        <h4>–û–±–µ–∑–ª–∏—á–µ–Ω–æ</h4>
                        <pre id="anonymizedPreviewAnon"></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Document Analysis Section -->
    <section class="section hidden" id="docanalysis">
        <div class="section-header">
            <h2 class="section-title">–ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞</h2>
            <span class="da-subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –ø–æ–∏—Å–∫–∞, –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏</span>
        </div>

        <!-- Upload Zone -->
        <div class="da-upload-zone" id="uploadZoneDA">
            <div class="upload-icon">üìä</div>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h3>
            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
            <span class="upload-formats">PDF, DOCX, DOC, XLSX, XLS, TXT ‚Ä¢ –¥–æ 50 –ú–ë</span>
            <input type="file" id="fileInputDA" accept=".pdf,.docx,.doc,.xlsx,.xls,.txt" hidden>
            <button class="btn btn-outline" onclick="document.getElementById('fileInputDA').click()">–í—ã–±—Ä–∞—Ç—å
                —Ñ–∞–π–ª</button>
        </div>

        <!-- File Info -->
        <div class="da-file-info hidden" id="daFileInfo">
            <div class="da-file-badge">
                <span class="da-file-icon">üìÑ</span>
                <div class="da-file-details">
                    <span class="da-file-name" id="daFileName"></span>
                    <span class="da-file-size" id="daFileSize"></span>
                </div>
                <button class="btn btn-outline btn-sm" id="daRemoveFile" onclick="daRemoveDocument()">‚úï</button>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="da-stats-grid hidden" id="daStatsGrid">
            <div class="da-stat-card">
                <span class="da-stat-icon">üìë</span>
                <span class="da-stat-value" id="daSheetsCount">0</span>
                <span class="da-stat-label">–õ–∏—Å—Ç–æ–≤ / –°—Ç—Ä–∞–Ω–∏—Ü</span>
            </div>
            <div class="da-stat-card">
                <span class="da-stat-icon">üìë</span>
                <span class="da-stat-value" id="daTotalTokens">0</span>
                <span class="da-stat-label">–¢–æ–∫–µ–Ω–æ–≤</span>
            </div>
            <div class="da-stat-card">
                <span class="da-stat-icon">üí∞</span>
                <span class="da-stat-value" id="daEstCost">~0.00 —Ä—É–±</span>
                <span class="da-stat-label">
                    <input type="number" id="daCostRate" value="100" step="1" min="0"
                        style="width: 60px; padding: 2px;">
                    —Ä—É–±/1–∫
                </span>
            </div>
        </div>

        <!-- Sheet Details (Collapsed by default) -->
        <details class="da-sheets-details hidden" id="daSheetsDetails">
            <summary>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –ª–∏—Å—Ç–∞–º</summary>
            <div class="da-sheets-list" id="daSheetsList"></div>
        </details>

        <!-- Tools Panel -->
        <div class="da-tools-panel hidden" id="daToolsPanel">

            <!-- Custom Prompt -->
            <div class="da-custom-prompt-box">
                <label for="daCustomPrompt">üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–∫–∞–∑–∞–Ω–∏—è –¥–ª—è AI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <textarea id="daCustomPrompt" class="da-custom-prompt" rows="2"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–°—É–º–º–∞—Ä–∏–∑–∏—Ä—É–π —Ç–æ–ª—å–∫–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é —á–∞—Å—Ç—å' –∏–ª–∏ '–°–¥–µ–ª–∞–π —Ç–∞–±–ª–∏—Ü—É —Å –§–ò–û –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç—è–º–∏'"></textarea>
            </div>

            <!-- OCR Tool -->
            <div class="da-tool-section">
                <details>
                    <summary>
                        <h4>üîç OCR / –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≤ DOCX</h4>
                    </summary>
                    <div class="da-tool-content">
                        <p class="da-hint">–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å–∫–∞–Ω—ã –∏–ª–∏ PDF-–∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏.
                        </p>
                        <div class="da-actions-row">
                            <button class="btn btn-primary" id="daOcrBtn" onclick="daOCR()">–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</button>
                            <button class="btn btn-outline hidden" id="daDownloadOcrBtn" onclick="daDownloadOCR()">‚¨áÔ∏è
                                –°–∫–∞—á–∞—Ç—å DOCX</button>
                            <button class="btn btn-outline hidden" id="daDownloadOcrPdfBtn"
                                onclick="daDownloadOCRPDF()">‚¨áÔ∏è PDF</button>
                        </div>
                        <div class="da-result-box hidden" id="daOcrResult"></div>
                    </div>
                </details>
            </div>

            <!-- Q&A -->
            <div class="da-tool-section">
                <details>
                    <summary>
                        <h4>‚ùì –í–æ–ø—Ä–æ—Å –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É</h4>
                    </summary>
                    <div class="da-tool-content">
                        <div class="da-input-row">
                            <input type="text" id="daAskInput" class="da-input"
                                placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç–∞...">
                            <button class="btn btn-primary btn-sm" id="daAskBtn" onclick="daAsk()">–°–ø—Ä–æ—Å–∏—Ç—å</button>
                        </div>
                        <div class="da-result-box hidden" id="daAskResult"></div>
                    </div>
                </details>
            </div>

            <!-- Summarize -->
            <div class="da-tool-section">
                <details>
                    <summary>
                        <h4>üìã –ü—Ä–æ—Ç–æ–∫–æ–ª / –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è</h4>
                    </summary>
                    <div class="da-tool-content">
                        <div class="da-actions-row">
                            <button class="btn btn-primary" id="daSummarizeBtn" onclick="daSummarize()">–°–æ–∑–¥–∞—Ç—å
                                –ø—Ä–æ—Ç–æ–∫–æ–ª</button>
                            <button class="btn btn-outline hidden" id="daDownloadProtocolBtn"
                                onclick="daDownloadProtocol()">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å DOCX</button>
                        </div>
                        <div class="da-result-box hidden" id="daSummaryResult"></div>
                    </div>
                </details>
            </div>

            <!-- Table Generation -->
            <div class="da-tool-section">
                <details>
                    <summary>
                        <h4>üìä –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü</h4>
                    </summary>
                    <div class="da-tool-content">
                        <p class="da-hint">AI —Å–æ–∑–¥–∞—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞.</p>
                        <div class="da-actions-row">
                            <button class="btn btn-primary" id="daTableBtn" onclick="daGenerateTable()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
                                —Ç–∞–±–ª–∏—Ü—ã</button>
                            <button class="btn btn-outline hidden" id="daDownloadTableBtn"
                                onclick="daDownloadTable()">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å XLSX</button>
                        </div>
                        <div class="da-result-box hidden" id="daTableResult"></div>
                    </div>
                </details>
            </div>

            <div class="da-tool-section">
                <details>
                    <summary>
                        <h4>üß† –ú–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã –∏ —Å—Ö–µ–º—ã</h4>
                    </summary>
                    <div class="da-tool-content">
                        <p class="da-hint">AI —Å–æ–∑–¥–∞—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –≤–∏–¥–µ –¥–∏–∞–≥—Ä–∞–º–º—ã.</p>
                        <div class="da-edit-actions">
                            <div class="da-edit-group">
                                <label>–¢–∏–ø —Å—Ö–µ–º—ã:</label>
                                <select id="daStructureMode" class="select-input">
                                    <option value="mindmap">–ú–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ (Mindmap)</option>
                                    <option value="flowchart">–ë–ª–æ–∫-—Å—Ö–µ–º–∞ (Flowchart)</option>
                                    <option value="graph">–ì—Ä–∞—Ñ —Å–≤—è–∑–µ–π (Graph)</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" id="daStructureBtn" style="margin-top: 10px;"
                                onclick="daGenerateStructure()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                        </div>
                        <div class="da-result-actions hidden" id="daStructureDownloadActions" style="margin-top: 15px;">
                            <button class="btn btn-outline" onclick="daDownloadMermaidPng()">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å PNG</button>
                            <button class="btn btn-outline" onclick="daDownloadMermaidSvg()">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å SVG</button>
                        </div>
                        <div class="da-result-box hidden" id="daStructureResult" style="overflow: auto;">
                            <!-- Mermaid diagrarm will be rendered here -->
                            <div id="daMermaidContainer"></div>
                        </div>
                    </div>
                </details>
            </div>

            <!-- Check & Edit -->
            <div class="da-tool-section">
                <details>
                    <summary>
                        <h4>‚ú® –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h4>
                    </summary>
                    <div class="da-tool-content">
                        <p class="da-hint">AI –∏—Å–ø—Ä–∞–≤–∏—Ç –æ—à–∏–±–∫–∏, —É–ª—É—á—à–∏—Ç —Å—Ç–∏–ª—å –∏–ª–∏ –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç, —Å–æ—Ö—Ä–∞–Ω–∏–≤
                            —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.</p>
                        <div class="da-edit-actions">
                            <div class="da-edit-group">
                                <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
                                <select id="daEditMode" class="select-input">
                                    <option value="fix">–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –∏ –æ–ø–µ—á–∞—Ç–∫–∏</option>
                                    <option value="style">–£–ª—É—á—à–∏—Ç—å —Å—Ç–∏–ª—å (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π)</option>
                                    <option value="toc">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ</option>
                                    <option value="paraphrase">–ü–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞—Ç—å (–ø–æ–≤—ã—Å–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å)</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" id="daEditBtn" onclick="daEditDocument()"
                                style="margin-top: 10px;">–ó–∞–ø—É—Å—Ç–∏—Ç—å
                                –æ–±—Ä–∞–±–æ—Ç–∫—É</button>
                        </div>
                        <div class="da-result-actions hidden" id="daEditDownloadActions" style="margin-top: 15px;">
                            <button class="btn btn-outline" id="daDownloadEditDocxBtn" onclick="daDownloadEditDocx()">‚¨áÔ∏è
                                –°–∫–∞—á–∞—Ç—å DOCX</button>
                            <button class="btn btn-outline" id="daDownloadEditPdfBtn" onclick="daDownloadEditPdf()">‚¨áÔ∏è
                                –°–∫–∞—á–∞—Ç—å PDF</button>
                        </div>
                        <div class="da-result-box hidden" id="daEditResult"></div>
                    </div>
                </details>
            </div>

        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <span class="logo-icon">üìÑ</span> –°—Ä–∞–≤–Ω–µ–Ω–∏–µ–î–æ–∫ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
            </div>
            <div class="footer-links">
                <a href="/api/v1/health" target="_blank">–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</a>
            </div>
        </div>
    </footer>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="app.js"></script>
</body>

</html>