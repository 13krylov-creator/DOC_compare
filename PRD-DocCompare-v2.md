# üìÑ PRD: DocumentCompare Platform
## Multi-Tenant Document Comparison & Analysis Engine

**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞:** –Ø–Ω–≤–∞—Ä—å 2026  
**–°—Ç–∞—Ç—É—Å:** Ready for Development  
**–§–æ–∫—É—Å:** Smart Document Diff, Not Workflow/Approval

---

## 1. EXECUTIVE SUMMARY

**DocumentCompare** ‚Äî —ç—Ç–æ SaaS –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è **–≥–ª—É–±–æ–∫–æ–≥–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è** PDF –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –°–∏—Å—Ç–µ–º–∞ –ø–æ–º–æ–≥–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞–º **–ø–æ–Ω—è—Ç—å, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å** –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏, –Ω–∞–π—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∞–Ω–∞–ª–∏–∑–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–ª–∏—Ç—å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏.

### –ö–ª—é—á–µ–≤–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –æ—Ç –¥—Ä—É–≥–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –ù–µ –ø—Ä–æ—Å—Ç–æ –≤—ã–¥–µ–ª—è–µ—Ç –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (—ç—Ç–æ –¥–µ–ª–∞–µ—Ç diff)
- **–ü–æ–Ω–∏–º–∞–µ—Ç —Å—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π**: "–ü–ª–∞—Ç—ë–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏–∑–º–µ–Ω–∏–ª–∏—Å—å —Å 90 –Ω–∞ 30 –¥–Ω–µ–π" –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ "—Ç–µ–∫—Å—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è"
- –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∂–∏–º–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á
- Beautiful timeline visualization –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π merge —Ä–∞–∑–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞
- –¢—Ä—É–¥–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –±–æ–ª—å—à–æ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ
- –í–µ—Ä—Å–∏–∏ file naming: "contract_v1_final_REAL_v2_approved.pdf" ‚Äî –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å
- –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –¥–≤–µ –≤–µ—Ä—Å–∏–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –æ–Ω–∏ –±–æ–ª—å—à–∏–µ
- –ö–æ–≥–¥–∞ –µ—Å—Ç—å 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç —Ä–∞–∑–Ω—ã—Ö –æ—Ç–¥–µ–ª–æ–≤ ‚Äî –∫–∞–∫ –∏—Ö —Å–ª–∏—Ç—å?

### –†–µ—à–µ–Ω–∏–µ
- **Multi-Mode Comparison**: Line-by-line, Semantic, Impact, Clause, Legal diff
- **Smart Timeline**: Beautiful –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **AI-Powered Insights**: LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç, —á—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Automatic Merge**: –°–ª–∏—è–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã—Ö –≤–µ—Ä—Å–∏–π —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º —Ç–æ—á–µ–∫ —Ä–∞–∑–Ω–æ–≥–ª–∞—Å–∏—è
- **Risk Signals**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª—è–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## 2. VISION & GOALS

### Vision
–°—Ç–∞—Ç—å –ª—É—á—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π –¥–ª—è **–ø–æ–Ω–∏–º–∞–Ω–∏—è** —Ç–æ–≥–æ, –∫–∞–∫ –∏–∑–º–µ–Ω—è–ª–∏—Å—å –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –∏–Ω—Å–∞–π—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –æ–±—ã—á–Ω—ã–º diff –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º.

### OKRs (Objectives & Key Results)
1. **Reduce time to understand changes** from 30 min ‚Üí 5 min (per contract)
2. **Capture 100% of meaningful changes** —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏ —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π
3. **Enable 80% non-conflicting merges** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. **Risk detection accuracy** > 95% for critical parameters
5. **Timeline visualization** becomes workflow centerpiece (–∫—Ä–∞—Å–æ—Ç–∞ + —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)

---

## 3. TARGET USERS & PERSONAS

### Persona 1: **Legal Manager (–î–∞—Ä—å—è)**
- Role: Head of Legal Department
- Goal: –ë—ã—Å—Ç—Ä–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- Task: "5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –æ—Ç —Ä–∞–∑–Ω—ã—Ö –æ—Ç–¥–µ–ª–æ–≤ ‚Äî —á—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è?"
- Usage: –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã, –≤–∏–¥–∏—Ç semantic diff, –ø–æ–Ω–∏–º–∞–µ—Ç —Ä–∏—Å–∫–∏

### Persona 2: **Procurement Manager (–ü–µ—Ç—Ä)**
- Role: Procurement/Sourcing Lead
- Goal: –£–ø—Ä–∞–≤–ª—è—Ç—å –≤–µ—Ä—Å–∏—è–º–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤, –Ω–∞—Ö–æ–¥–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- Task: "–û—Ç—Å–ª–µ–¥–∏—Ç—å, –∫–∞–∫ –º–µ–Ω—è–ª–∏—Å—å –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —á–µ—Ä–µ–∑ 10 –∏—Ç–µ—Ä–∞—Ü–∏–π"
- Usage: –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç timeline, –≤–∏–¥–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π

### Persona 3: **Finance Controller (–ú–∞—Ä–∏—è)**
- Role: Finance Department
- Goal: –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å—É–º–º—ã, —Å—Ä–æ–∫–∏, —à—Ç—Ä–∞—Ñ—ã)
- Task: "–ö–∞–∫–∏–µ —Å—É–º–º—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏?"
- Usage: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç "Impact Mode" –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤

### Persona 4: **Contract Analyst (–ò–≤–∞–Ω)**
- Role: Contract Review / Risk Management
- Goal: –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º
- Task: "–ö–∞–∫–∏–µ –∫–ª–∞—É–∑—É–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã/—É–¥–∞–ª–µ–Ω—ã? –ö–∞–∫–∏–µ –∫–ª—é—á–µ–≤—ã–µ —É—Å–ª–æ–≤–∏—è?"
- Usage: –†–µ–∂–∏–º "Clause Analysis", "Legal Diff"

### Persona 5: **Data Officer (–ë–æ—Ä–∏—Å)**
- Role: Compliance / Audit
- Goal: –¢—Ä–æ–∏—Ç—å audit trail, –æ—Ç—Å–ª–µ–¥–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- Task: "–ö—Ç–æ —á—Ç–æ –º–µ–Ω—è–ª? –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è compliance"
- Usage: –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/JSON, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å audit systems

---

## 4. CORE PRODUCT ARCHITECTURE

### 4.1 Document Comparison Modes

**–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç 5+ —Ä–µ–∂–∏–º–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–¥–∞—á–∏:**

#### **Mode 1: Line-by-Line Diff** (–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π)
–ß—Ç–æ —ç—Ç–æ: –ü–æ–±–∞–π—Ç–æ–≤–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, –∫–∞–∫ –≤ Git
- –ö—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏: —É–¥–∞–ª–µ–Ω–æ
- –ó–µ–ª—ë–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏: –¥–æ–±–∞–≤–ª–µ–Ω–æ
- –ñ—ë–ª—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏: –∏–∑–º–µ–Ω–µ–Ω–æ
- Context lines: 3-5 —Å—Ç—Ä–æ–∫ –¥–æ/–ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –í–°–ï –∏–∑–º–µ–Ω–µ–Ω–∏—è, –¥–∞–∂–µ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é

**UI:**
- Side-by-side view (left: original, right: modified)
- –°–ª–∞–π–¥–µ—Ä –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ context lines
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ (‚Üë/‚Üì –∫–Ω–æ–ø–∫–∏)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: +47 —Å—Ç—Ä–æ–∫, -23 —Å—Ç—Ä–æ–∫–∏, 15 –∏–∑–º–µ–Ω–µ–Ω–æ

---

#### **Mode 2: Semantic Diff** (–£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑)
–ß—Ç–æ —ç—Ç–æ: LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–º—ã—Å–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π, –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ —Ç–∏–ø–∞–º

–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- `DEFINITION_CHANGE`: "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏—è –∏–∑–º–µ–Ω–∏–ª–æ—Å—å"
- `NUMERICAL_CHANGE`: "–°—É–º–º–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å —Å 100k –Ω–∞ 150k"
- `TEMPORAL_CHANGE`: "–°—Ä–æ–∫ –∏–∑–º–µ–Ω–∏–ª—Å—è —Å 30 –Ω–∞ 60 –¥–Ω–µ–π"
- `SCOPE_CHANGE`: "–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —É—Å–ª—É–≥–∞/–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ"
- `TERMINOLOGY`: "–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–º—ã—Å–ª–∞"
- `STRUCTURE_CHANGE`: "–ü—É–Ω–∫—Ç –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 3 –≤ —Ä–∞–∑–¥–µ–ª 5"

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç + –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç
- LLM summary: "–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç?"
- Impact score: –∫–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥–æ–≥–æ–≤–æ—Ä (0-100)
- –†–∏—Å–∫-—Ñ–ª–∞–≥: CRITICAL/MAJOR/MINOR

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å—É—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∞–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è

**UI:**
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Ç–∏–ø–∞–º
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º/–Ω–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º
- –ò–∫–æ–Ω–∫–∏: üî¥ CRITICAL, üü° MAJOR, üü¢ MINOR
- "Why does this matter?" explanation
- Filter by type –∏–ª–∏ severity

---

#### **Mode 3: Impact Analysis** (–ê–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è)
–ß—Ç–æ —ç—Ç–æ: –§–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- **Financial:** —Å—É–º–º—ã, —Å–∫–∏–¥–∫–∏, —à—Ç—Ä–∞—Ñ—ã, —É—Å–ª–æ–≤–∏—è –ø–ª–∞—Ç–µ–∂–∞
- **Temporal:** –¥–∞—Ç—ã, —Å—Ä–æ–∫–∏, deadlines, renewal terms
- **Obligations:** –∫—Ç–æ –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å —á—Ç–æ, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- **Penalties:** —à—Ç—Ä–∞—Ñ—ã, –ø–µ–Ω–∏, —Å–∞–Ω–∫—Ü–∏–∏
- **Termination:** —É—Å–ª–æ–≤–∏—è —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏—è
- **Liability:** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Üí –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (–¥–ª—è —á–∏—Å–µ–ª)
- "Is this significant?" (–ø–æ—Ä–æ–≥ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏)
- Business context: –ø–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑, –ø–æ–Ω–∏–º–∞–Ω–∏–µ –¥–µ–ª–æ–≤—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π

**UI:**
- –¢–∞–±–ª–∏—Ü–∞: –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –ó–Ω–∞—á–∏–º–æ—Å—Ç—å
- Color-coded rows (–∑–µ–ª—ë–Ω—ã–π/–∂—ë–ª—Ç—ã–π/–∫—Ä–∞—Å–Ω—ã–π)
- Pie chart: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —Ç–∏–ø–∞–º
- "What changed the most?" dashboard

---

#### **Mode 4: Clause-by-Clause Analysis** (–ê–Ω–∞–ª–∏–∑ –∫–ª–∞—É–∑—É–ª)
–ß—Ç–æ —ç—Ç–æ: –†–∞–∑–±–∏–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—É–∑—É–ª—ã, —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏—Ö

ËØÜ—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–ª–∞—É–∑—É–ª:
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (Definitions)
- –ü–ª–∞—Ç—ë–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (Payment Terms)
- –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å (Liability)
- –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å (Confidentiality)
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å (IP Rights)
- –†–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ (Termination)
- –ü—Ä–æ—á–∏–µ —É—Å–ª–æ–≤–∏—è (Other Terms)

–î–ª—è –∫–∞–∂–¥–æ–π –∫–ª–∞—É–∑—É–ª—ã:
- Status: ADDED / REMOVED / MODIFIED / UNCHANGED
- Old clause text vs New clause text
- LLM-generated summary
- "Impact on overall agreement"

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è, –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**UI:**
- –°–ø–∏—Å–æ–∫ –∫–ª–∞—É–∑—É–ª —Å –∏–∫–æ–Ω–∫–∞–º–∏ status
- Expandable: click ‚Üí see full old vs new
- Timeline –ø–æ –∫–ª–∞—É–∑—É–ª–∞–º (–∫–∞–∫–∞—è –∫–ª–∞—É–∑—É–ª–∞ –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –º–µ–Ω—è–ª–∞—Å—å?)
- Export —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

---

#### **Mode 5: Legal Diff** (–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑)
–ß—Ç–æ —ç—Ç–æ: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è —é—Ä–∏—Å—Ç–æ–≤

–§–æ–∫—É—Å –Ω–∞:
- –û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ vs –ü—Ä–∞–≤–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è (exceptions)
- –£—Å–ª–æ–≤–∏—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —Å–∏–ª—É
- –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–ø–æ—Ä–æ–≤
- –ü—Ä–∏–º–µ–Ω—è–µ–º–æ–µ –ø—Ä–∞–≤–æ (governing law)
- Force majeure
- Confidentiality & NDA

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:
- –ö–∞–∫–æ–≤–∞ –±—ã–ª–∞ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞
- –ö–∞–∫ –æ–Ω–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–º—è–≥—á–µ–Ω–∏—é

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –ì–ª—É–±–æ–∫–∏–π —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

**UI:**
- –°–ø–∏—Å–æ–∫ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- Risk matrix: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å √ó –≤–ª–∏—è–Ω–∏–µ
- Expert notes: –ø–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ
- Comparison of legal frameworks (–µ—Å–ª–∏ —Ä–∞–∑–Ω–æ–µ –ø—Ä–∏–º–µ–Ω—è–µ–º–æ–µ –ø—Ä–∞–≤–æ)

---

#### **Mode 6: Timeline Visualization** (–ì–ª–∞–≤–Ω–∞—è —Ñ–∏—à–∫–∞)
–ß—Ç–æ —ç—Ç–æ: Beautiful, interactive timeline –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **Vertical Timeline** (–∫–∞–∫ –≤ Figma –≤–µ—Ä—Å–∏–∏)
  - –ö–∞–∂–¥–∞—è –≤–µ—Ä—Å–∏—è = —Ç–æ—á–∫–∞ –Ω–∞ timeline
  - –î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏
  - –ö—Ç–æ –∑–∞–≥—Ä—É–∑–∏–ª (avatar)
  - Brief summary: "3 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å"
  - –ò–∫–æ–Ω–∫–∏: üî¥ 3 CRITICAL, üü° 5 MAJOR

- **Interactive Features:**
  - Click –Ω–∞ –≤–µ—Ä—Å–∏—é ‚Üí –æ—Ç–∫—Ä—ã—Ç—å —Ñ—É–ª–ª-diff vs previous
  - Drag to compare any two versions
  - Hover ‚Üí preview –∏–∑–º–µ–Ω–µ–Ω–∏–π (popup)
  - Zoom in/out: –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã

- **Visual Indicators:**
  - –¢–æ–ª—â–∏–Ω–∞ –ª–∏–Ω–∏–∏ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–±–æ–ª—å—à–µ changes = —Ç–æ–ª—â–µ)
  - –¶–≤–µ—Ç —Ç–æ—á–∫–∏ = risk level (–∫—Ä–∞—Å–Ω—ã–π = CRITICAL, –∂—ë–ª—Ç—ã–π = MAJOR)
  - –î—É–≥–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ (–µ—Å–ª–∏ merge –ø—Ä–æ–∏–∑–æ—à—ë–ª)

- **Metadata –Ω–∞ timeline:**
  - File name
  - Size
  - Page count
  - Change count
  - Key changes: "Payment: 90‚Üí30 days, Sum: 100k‚Üí150k"

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –û–±–∑–æ—Ä –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏, –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**UI:**
```
Timeline View:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  v1.0 (Jan 15)  ‚Üí  v1.1 (Jan 16)  ‚Üí  v1.2 (Jan 17) ‚îÇ
‚îÇ     üë§ Ivan        üë§ Maria         üë§ Finance      ‚îÇ
‚îÇ     ‚óè              ‚óè                ‚óè              ‚îÇ
‚îÇ  üü¢ MINOR      üü° MAJOR         üî¥ CRITICAL      ‚îÇ
‚îÇ  (1 change)    (5 changes)      (3 changes!)     ‚îÇ
‚îÇ                                                    ‚îÇ
‚îÇ  ‚Üì Click –ª—é–±—É—é –≤–µ—Ä—Å–∏—é –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Detail Panel:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Version 1.2 - Detailed Analysis           ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ üî¥ CRITICAL CHANGES (3):                 ‚îÇ
‚îÇ  ‚Ä¢ Payment days: 90 ‚Üí 30                 ‚îÇ
‚îÇ  ‚Ä¢ Total sum: 100k ‚Üí 150k RUB            ‚îÇ
‚îÇ  ‚Ä¢ Liability cap: REMOVED                ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ üü° MAJOR CHANGES (5):                    ‚îÇ
‚îÇ  ‚Ä¢ Added: Confidentiality clause         ‚îÇ
‚îÇ  ‚Ä¢ Modified: Termination conditions      ‚îÇ
‚îÇ  [see more...]                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### 4.2 Document Upload & Management

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ PDF, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ OCR + LLM

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- [ ] Drag-and-drop –∑–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –º—É–ª—å—Ç–∏–ø–ª–∞ PDF
- [ ] Support —Ñ–æ—Ä–º–∞—Ç–æ–≤: PDF (–æ—Å–Ω–æ–≤–Ω–æ–π), DOCX, TXT
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π OCR —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å Chandra –Ω–∞ Ubuntu
- [ ] –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞ (—Ä–∞–∑–¥–µ–ª—ã, –∫–ª–∞—É–∑—É–ª—ã, —Ç–∞–±–ª–∏—Ü—ã)
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ raw PDF + extracted text –≤ –ë–î
- [ ] Metadata: filename, upload_date, uploaded_by, file_size, page_count, hash
- [ ] –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ (folder/project) –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] Soft delete (–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ) –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] Full-text search –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] Automatic version detection: –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª —Å –ø–æ—Ö–æ–∂–∏–º –∏–º–µ–Ω–µ–º, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å –∫–∞–∫ –≤–µ—Ä—Å–∏—é

**UI/UX:**
- –≠–∫—Ä–∞–Ω: Document Library (grid/list view —Å preview)
- Upload zone: drag-and-drop –∏–ª–∏ –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞
- –î–æ–∫—É–º–µ–Ω—Ç card: thumbnail PDF preview, metadata, last_modified
- Batch select –¥–ª—è bulk operations

**Backend API:**
```
POST /api/v1/documents/upload
POST /api/v1/documents/batch-upload
GET /api/v1/documents
GET /api/v1/documents/{id}
DELETE /api/v1/documents/{id}
PUT /api/v1/documents/{id}/archive
GET /api/v1/documents/search?q=...
GET /api/v1/documents/{id}/versions
```

---

### 4.3 Smart Semantic Diff Engine

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ—Ä–¥—Ü–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ‚Äî —É–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

#### 4.3.1 Diff Algorithm (Multi-Layer)

**Layer 1: Text Tokenization**
- –†–∞–∑–±–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ clauses/paragraphs/sentences
- Preserving document structure
- Identify sections (headers, numbered lists, tables)

**Layer 2: Semantic Embedding**
- Embed –∫–∞–∂–¥—ã–π –±–ª–æ–∫ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ sentence-transformers (local)
- –°–æ–∑–¥–∞—Ç—å embedding vectors –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –±–ª–æ–∫–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: cosine similarity + Levenshtein distance

**Layer 3: Change Classification**
```
DELETED      ‚Üí —Ç–µ–∫—Å—Ç –±—ã–ª –≤ v1, –Ω–µ—Ç –≤ v2
ADDED        ‚Üí —Ç–µ–∫—Å—Ç–∞ –Ω–µ –±—ã–ª–æ –≤ v1, –µ—Å—Ç—å –≤ v2
MODIFIED     ‚Üí —Ç–µ–∫—Å—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤)
MOVED        ‚Üí —Ç–µ–∫—Å—Ç –Ω–∞ –º–µ—Å—Ç–µ, –Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
REWORDED     ‚Üí —Å–º—ã—Å–ª —Ç–æ—Ç –∂–µ, —Å–ª–æ–≤–∞ –¥—Ä—É–≥–∏–µ (semantic similarity > 0.9)
SEMANTIC_SHIFT ‚Üí —Å–º—ã—Å–ª –∏–∑–º–µ–Ω–∏–ª—Å—è (similarity < 0.7)
```

**Layer 4: Critical Parameter Detection**
- Regex –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è:
  - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å—É–º–º—ã: `\d+(\.\d{2})?\s*(USD|RUB|EUR|k|m)`
  - –î–∞—Ç—ã: `\d{1,2}\.\d{1,2}\.\d{4}` –∏–ª–∏ ISO
  - –°—Ä–æ–∫–∏: `\d+\s*(–¥–Ω—è|–¥–Ω–µ–π|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤|–ª–µ—Ç|years|months|days)`
  - –ü—Ä–æ—Ü–µ–Ω—Ç—ã: `\d+(\.\d+)?\s*%`
  - –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: "–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", "—à—Ç—Ä–∞—Ñ", "—Ä–∏—Å–∫", "–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ", "–∑–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è", "–¥–æ–ª–∂–µ–Ω"

**Layer 5: Impact Scoring**
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è: how significant is it?
- Threshold –ø–æ —Ç–∏–ø—É:
  - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ: –µ—Å–ª–∏ > 10% –æ—Ç —Å—É–º–º—ã = CRITICAL
  - –í—Ä–µ–º–µ–Ω–Ω—ã–µ: –µ—Å–ª–∏ < 30 –¥–Ω–µ–π = CRITICAL
  - –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞ = CRITICAL
  - –¢–µ–∫—Å—Ç–æ–≤—ã–µ: –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ = MINOR

#### 4.3.2 Comparison Output

```json
{
  "document_id_v1": "doc_123_v1",
  "document_id_v2": "doc_123_v2",
  "comparison_id": "comp_456",
  "generated_at": "2026-01-19T21:00:00Z",
  
  "summary": {
    "total_changes": 47,
    "critical_changes": 3,
    "major_changes": 12,
    "minor_changes": 32,
    "similarity_score": 0.78
  },
  
  "changes": [
    {
      "id": "change_001",
      "type": "SEMANTIC_SHIFT",
      "classification": "NUMERICAL_CHANGE",
      "severity": "CRITICAL",
      "location": "section_3.2",
      "original_text": "Payment shall be due within 90 days from invoice date",
      "new_text": "Payment shall be due within 30 days from invoice date",
      "ai_summary": "Payment deadline significantly shortened from 90 to 30 days",
      "impact_score": 95,
      "business_context": "This dramatically reduces credit period, increasing cash flow pressure"
    },
    {
      "id": "change_002",
      "type": "ADDED",
      "classification": "SCOPE_CHANGE",
      "severity": "MAJOR",
      "location": "section_5_new",
      "original_text": null,
      "new_text": "Confidentiality: All proprietary information must be kept confidential for 3 years after termination",
      "ai_summary": "New confidentiality obligations added",
      "impact_score": 67,
      "business_context": "Adds post-termination confidentiality requirements"
    }
  ],
  
  "financial_impact": {
    "changes": [
      { "parameter": "Total Amount", "original": 1000000, "new": 1500000, "currency": "RUB", "change_percent": 50 },
      { "parameter": "Payment Days", "original": 90, "new": 30, "unit": "days", "change_percent": -67 }
    ]
  },
  
  "clauses": {
    "status": {
      "added": ["Confidentiality", "Force Majeure"],
      "removed": ["Warranty Period"],
      "modified": ["Liability Cap", "Termination"]
    }
  }
}
```

**Backend API:**
```
POST /api/v1/documents/{id1}/compare/{id2}
  Query: mode=line-by-line|semantic|impact|clause|legal|timeline
  ‚Üí Returns: detailed comparison result

GET /api/v1/documents/{id1}/compare/{id2}
  ‚Üí Retrieve previously generated comparison

GET /api/v1/documents/{id}/versions
  ‚Üí List all versions for timeline

GET /api/v1/documents/{id1}/semantic-diff
  ‚Üí Semantic-specific comparison
```

---

### 4.4 Automatic Merge (Multi-Way)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–∏—è–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

#### 4.4.1 Three-Way Merge
- Input: base version + 2 modified versions
- –ê–ª–≥–æ—Ä–∏—Ç–º: –∫–∞–∂–¥—ã–π –±–ª–æ–∫ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- –ï—Å–ª–∏ –æ–±–µ –≤–µ—Ä—Å–∏–∏ –º–µ–Ω—è—é—Ç –æ–¥–∏–Ω –±–ª–æ–∫ –ø–æ-—Ä–∞–∑–Ω–æ–º—É = CONFLICT
- Non-conflicting changes: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –æ–±–µ
- Output: merged document + conflict markers

#### 4.4.2 Multi-Way Merge (N –≤–µ—Ä—Å–∏–π)
- –ó–∞–≥—Ä—É–∑–∏—Ç—å 2-10 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç consensus version:
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞: –∫–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —á–∞—â–µ?
  - –ï—Å–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ —á–∞—Å—Ç–æ: –∫–æ–Ω—Ñ–ª–∏–∫—Ç
- Merge strategies:
  - `CONSENSUS`: –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ (most common variant wins)
  - `MOST_RECENT`: –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è
  - `MANUAL`: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞

#### 4.4.3 Conflict Resolution UI

**–ö–æ–≥–¥–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ < 5:**
- Inline resolution (–≤—Å–µ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞: 2-3 –≤–∞—Ä–∏–∞–Ω—Ç–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç

**–ö–æ–≥–¥–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ > 5:**
- Wizard-like interface
- –®–∞–≥ –∑–∞ —à–∞–≥–æ–º: conflict 1 of 7
- Preview merged result after each step

**UI:**
```
Conflict Resolution:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Merge Conflicts: 3 of 7            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Conflict #3: Payment Terms         ‚îÇ
‚îÇ                                    ‚îÇ
‚îÇ Version A (Moscow):               ‚îÇ
‚îÇ ‚òê Payment: 30 days, 5% discount   ‚îÇ
‚îÇ                                    ‚îÇ
‚îÇ Version B (SPB):                  ‚îÇ
‚îÇ ‚òê Payment: 45 days, 3% discount   ‚îÇ
‚îÇ                                    ‚îÇ
‚îÇ Version C (Ekb):                  ‚îÇ
‚îÇ ‚òí Payment: 30 days, 0% discount   ‚îÇ
‚îÇ                                    ‚îÇ
‚îÇ Consensus: Version A (picked by 2) ‚îÇ
‚îÇ                                    ‚îÇ
‚îÇ [Back] [Next] [Preview Result]    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Backend API:**
```
POST /api/v1/documents/merge
  Body: { 
    document_ids: [id1, id2, id3],
    merge_strategy: "CONSENSUS|MOST_RECENT|MANUAL",
    base_version?: id_base
  }
  ‚Üí Returns: { merged_content, conflicts: [...], preview_url }

POST /api/v1/documents/merge/{merge_id}/resolve
  Body: { conflict_index, chosen_variant_index }
  ‚Üí Update merge

POST /api/v1/documents/merge/{merge_id}/finalize
  ‚Üí Create new document with merged content
```

---

### 4.5 Intelligent Timeline Visualization

**–û–ø–∏—Å–∞–Ω–∏–µ:** Beautiful, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è timeline –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **Main Timeline View**
   - –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è (–∫–∞–∫ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–º–∏—Ç–æ–≤ Git –∏–ª–∏ Figma –≤–µ—Ä—Å–∏–∏)
   - –ö–∞–∂–¥–∞—è –≤–µ—Ä—Å–∏—è = —É–∑–µ–ª (node) –Ω–∞ timeline
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ –ª–µ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω–µ —ç–∫—Ä–∞–Ω–∞

2. **Node Information (–ø—Ä–∏ hover/click)**
   - File name
   - Upload date & time
   - Uploaded by (avatar + name)
   - File size & page count
   - Quick stats: "15 changes, 3 CRITICAL, 5 MAJOR"
   - Visualization: —Ä–∞–¥–∞—Ä –∏–ª–∏ pie chart –∏–∑–º–µ–Ω–µ–Ω–∏–π

3. **Connectors Between Versions**
   - –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è A ‚Üí –≤–µ—Ä—Å–∏—è B: –ø—Ä–æ—Å—Ç–∞—è –ª–∏–Ω–∏—è
   - –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è = merge –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö: –¥—É–≥–æ–æ–±—Ä–∞–∑–Ω–∞—è –ª–∏–Ω–∏—è –∏–∑ –≤—Å–µ—Ö —Ä–æ–¥–∏—Ç–µ–ª–µ–π
   - Color-coded: –∑–µ–ª—ë–Ω—ã–π (minor), –∂—ë–ª—Ç—ã–π (major), –∫—Ä–∞—Å–Ω—ã–π (critical)

4. **Interaction Features**
   - Click –≤–µ—Ä—Å–∏—é ‚Üí –æ—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π diff vs previous
   - Ctrl+Click –¥–≤–µ –≤–µ—Ä—Å–∏–∏ ‚Üí –æ—Ç–∫—Ä—ã—Ç—å diff –º–µ–∂–¥—É –Ω–∏–º–∏
   - Drag version ‚Üí reorder (–µ—Å–ª–∏ —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫)
   - Search/filter timeline –ø–æ date, uploader, risk level

5. **Density Options**
   - Compact: —Ç–æ–ª—å–∫–æ –¥–∞—Ç—ã –∏ –∏–∫–æ–Ω–∫–∏
   - Normal: +file names, +change counts
   - Detailed: +full summaries, +file sizes

**Visual Design (Inspiration: Figma Version History)**
```
Timeline Example:

                v1.0 (Jan 15)         Created by Ivan
                    ‚Ä¢
                    ‚îÇ üü¢ MINOR (1 change)
                    ‚îÇ
                v1.1 (Jan 16)         Created by Maria
                    ‚Ä¢
                    ‚îÇ üü° MAJOR (5 changes)
                    ‚îÇ
          ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Ä¢‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï≤        Merged from Finance + Legal
         /          v1.2      \
    v1.2a (Jan 17) ‚îÇ v1.2b (Jan 17)   Two branches
        ‚Ä¢          ‚îÇ          ‚Ä¢
        ‚îÇ üî¥       ‚îÇ          ‚îÇ üü°
        ‚îÇCRITICAL  ‚îÇ          ‚îÇMAJOR
        ‚îÇ (3)      ‚îÇ          ‚îÇ (4)
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Ä¢‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                v1.3 (Jan 18)         Merged: Final version
                    ‚Ä¢
                    ‚îÇ
```

**Backend API:**
```
GET /api/v1/documents/{id}/timeline
  ‚Üí Returns: timeline data structure with all versions

GET /api/v1/documents/{id}/timeline/compact
  ‚Üí Returns: lightweight version for performance

GET /api/v1/documents/{id}/timeline/compare-path
  Query: from={version_id}&to={version_id}
  ‚Üí Returns: path of changes from one version to another
```

---

### 4.6 Entity Extraction & Structured Export

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

#### 4.6.1 Contract Entity Extraction

LLM (GPT-20B-oss) –≤—ã—è–≤–ª—è–µ—Ç:
- `parties`: —Å—Ç–æ—Ä–æ–Ω—ã –¥–æ–≥–æ–≤–æ—Ä–∞ (–∫–æ–º–ø–∞–Ω–∏—è, –§–ò–û, –∞–¥—Ä–µ—Å–∞, —Ä–µ–∫–≤–∏–∑–∏—Ç—ã)
- `effective_date`: –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
- `expiration_date`: –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- `renewal_term`: —É—Å–ª–æ–≤–∏—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è
- `payment_terms`: —É—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã (—Å—É–º–º–∞, —Å—Ä–æ–∫, —Å–ø–æ—Å–æ–±, —Ä–µ–∫–≤–∏–∑–∏—Ç—ã)
- `penalties`: —à—Ç—Ä–∞—Ñ—ã, –Ω–µ—É—Å—Ç–æ–π–∫–∏, —Ä–∞–∑–º–µ—Ä—ã
- `termination_clause`: —É—Å–ª–æ–≤–∏—è —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏—è, notice period
- `liability`: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, insurance
- `governing_law`: –∫–∞–∫–æ–µ –ø—Ä–∞–≤–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- `dispute_resolution`: –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–ø–æ—Ä–æ–≤
- `key_obligations`: –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Å—Ç–æ—Ä–æ–Ω
- `key_rights`: –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∞ —Å—Ç–æ—Ä–æ–Ω
- `confidentiality`: —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
- `ip_ownership`: –≤–ª–∞–¥–µ–Ω–∏–µ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é

#### 4.6.2 Structured Output & Export

```json
{
  "document_id": "doc_123",
  "extraction_timestamp": "2026-01-19T21:00:00Z",
  "confidence": 0.94,
  "entities": {
    "parties": [
      {
        "type": "legal_entity",
        "name": "–û–û–û –ü—Ä–∏–º–µ—Ä",
        "registration_number": "1234567890",
        "address": "–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è 1",
        "contact_person": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
        "email": "ivan@example.ru"
      }
    ],
    "dates": {
      "effective_date": "2026-01-20",
      "expiration_date": "2027-01-20",
      "renewal_term": "12 months auto-renew with 30 days notice"
    },
    "payment_terms": {
      "currency": "RUB",
      "total_amount": 1500000,
      "payment_schedule": [
        { "due_date": "2026-02-20", "amount": 500000, "note": "Advance" },
        { "due_date": "2026-04-20", "amount": 500000 },
        { "due_date": "2026-06-20", "amount": 500000 }
      ],
      "payment_method": "Bank transfer to account: ...",
      "early_payment_discount": "5% if paid within 10 days"
    },
    "penalties": [
      {
        "type": "late_payment_fine",
        "rate": "0.5% per day",
        "max_cap": "10% of payment"
      }
    ]
  }
}
```

#### 4.6.3 Export Formats
- [ ] JSON: –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- [ ] CSV: —Ç–∞–±–ª–∏—Ü–∞ —Å key-value
- [ ] iCal: –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (dates, deadlines)
- [ ] PDF Report: –∫—Ä–∞—Å–∏–≤–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–π –æ—Ç—á—ë—Ç
- [ ] Excel: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏—Å—Ç—ã –ø–æ —Ç–∏–ø–∞–º —Å—É—â–Ω–æ—Å—Ç–µ–π

**UI/UX:**
- –≠–∫—Ä–∞–Ω: Document Summary
- –ö–∞—Ä—Ç–æ—á–∫–∏: Parties, Dates, Payment Terms, Penalties, Obligations
- Each entity editable (–µ—Å–ª–∏ extraction –Ω–µ—Ç–æ—á–Ω–∞)
- –ö–Ω–æ–ø–∫–∏: "Export to JSON", "Add to Calendar", "Export PDF Report"

**Backend API:**
```
GET /api/v1/documents/{id}/extract
  ‚Üí Returns: structured JSON with all entities

PUT /api/v1/documents/{id}/extract/{entity_type}/{entity_id}
  ‚Üí Update extracted data if incorrect

GET /api/v1/documents/{id}/extract/export
  Query: format=json|csv|ical|pdf
  ‚Üí Returns: formatted export
```

---

### 4.7 Risk Analysis & Critical Change Detection

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

#### 4.7.1 Risk Dimensions

**Financial Risks:**
- –°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞: —Ñ–ª–∞–≥ –µ—Å–ª–∏ > 500k RUB
- –ü–ª–∞—Ç–µ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è: —Ñ–ª–∞–≥ –µ—Å–ª–∏ > 60 –¥–Ω–µ–π
- –®—Ç—Ä–∞—Ñ—ã: —Ñ–ª–∞–≥ –µ—Å–ª–∏ —à—Ç—Ä–∞—Ñ > 5% —Å—É–º–º—ã –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- –î–∏—Å–∫–æ–Ω—Ç—ã: —Ñ–ª–∞–≥ –µ—Å–ª–∏ discount > 20%
- Currency risks: —Ñ–ª–∞–≥ –µ—Å–ª–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –≤ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç–µ + –Ω–µ—Ç hedge

**Temporal Risks:**
- –°—Ä–æ–∫–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è: —Ñ–ª–∞–≥ –µ—Å–ª–∏ < 30 –¥–Ω–µ–π (tight timeline)
- –ü–µ–Ω–∏ –∑–∞ –ø—Ä–æ—Å—Ä–æ—á–∫—É: —Ñ–ª–∞–≥ –µ—Å–ª–∏ > 1% –≤ –¥–µ–Ω—å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ: —Ñ–ª–∞–≥ –µ—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω–æ–≥–æ opt-out
- Renewal notice: —Ñ–ª–∞–≥ –µ—Å–ª–∏ notice period < 30 –¥–Ω–µ–π

**Legal Risks:**
- –ò–Ω–¥–µ–º–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è: –µ—Å—Ç—å –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- Liability cap: —Ñ–ª–∞–≥ –µ—Å–ª–∏ –Ω–µ—Ç –∏–ª–∏ > contract value (—Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ)
- Arbitration clause: —Ñ–ª–∞–≥ –µ—Å–ª–∏ –Ω–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Å—É–¥—É (—Ä–∏—Å–∫)
- Governing law: –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ (complexity)
- IP ownership: —Ñ–ª–∞–≥ –µ—Å–ª–∏ –Ω–µ—è—Å–Ω–æ, –∫–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç IP
- Non-compete: —Ñ–ª–∞–≥ –µ—Å–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–µ

**Operational Risks:**
- Insurance requirements: –µ—Å—Ç—å –ª–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ, –∫–∞–∫–æ–π —Ä–∞–∑–º–µ—Ä
- Performance guarantees: –µ—Å—Ç—å –ª–∏ –≥–∞—Ä–∞–Ω—Ç–∏–∏, –∫–∞–∫–∏–µ SLA
- Compliance requirements: references –∫ regulations (GDPR, SOC 2, ISO27001)
- Force majeure: –µ—Å—Ç—å –ª–∏ protecting clause

#### 4.7.2 Change-Based Risk Detection

–ö–æ–≥–¥–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –¥–≤–µ –≤–µ—Ä—Å–∏–∏:
- –ö–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å?
- –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ª—É—á—à–µ –∏–ª–∏ —Ö—É–∂–µ?
- Magnitude: –Ω–∞—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–∏–º–æ?

```
Financial Risk Analysis:
- Payment days: 90 ‚Üí 30 = RED (cash flow pressure)
- Total sum: 100k ‚Üí 150k = RED (cost increase)
- Discount: 5% ‚Üí 0% = YELLOW (less favorable)

Legal Risk Analysis:
- Liability cap: 2x sum ‚Üí REMOVED = RED (unlimited liability!)
- Arbitration: yes ‚Üí no = RED (must go to court now)
```

#### 4.7.3 Risk Scoring

- –ö–∞–∂–¥—ã–π —Ä–∏—Å–∫: score (0-100)
- Overall risk score: weighted average
- Risk level: GREEN (0-30), YELLOW (31-70), RED (71-100)
- Change in risk between versions: was GREEN, now RED

**UI/UX:**
```
Risk Dashboard:

üî¥ RED RISKS (3):
  ‚Ä¢ Liability cap removed (score: 95)
  ‚Ä¢ Payment days reduced to 30 (score: 88)
  ‚Ä¢ Currency: RUB with no hedge (score: 75)

üü° YELLOW RISKS (5):
  ‚Ä¢ Renewal auto-renews without opt-out (score: 62)
  [more...]

üü¢ GREEN (8):
  ‚Ä¢ Clear arbitration clause (score: 15)
  [...]

Overall Risk: 72/100 (YELLOW)
Risk Trend: ‚Üë (increased by 25 points from v1.0)
```

**Backend API:**
```
GET /api/v1/documents/{id}/risk-analysis
  ‚Üí Returns: { risks: [...], overall_score, level, trend }

GET /api/v1/documents/{id1}/risk-comparison/{id2}
  ‚Üí Returns: risk diff between two versions

POST /api/v1/documents/{id}/risk-assessment/acknowledge
  Body: { risk_id, action: "accept|mitigate|escalate" }
  ‚Üí Track risk decisions
```

---

## 5. ADVANCED FEATURES (Phase 2)

### 5.1 Clause Library & Pattern Matching
- –°–æ–∑–¥–∞—Ç—å library —Ç–∏–ø–æ–≤—ã—Ö –∫–ª–∞—É–∑—É–ª (standard templates)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–ª–∞—É–∑—É–ª –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏
- "Clauses matched: 87/90, new clauses: 2, removed: 1"
- Suggest standard clause if missing

### 5.2 Compliance Checking Against Template
- Upload —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç (template)
- System –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: –≤—Å–µ –ª–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—É–∑—É–ª—ã –µ—Å—Ç—å?
- Flags: missing clauses, non-standard terms vs template
- Compliance score (%)

### 5.3 Document Repository Analytics
- –°–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π –≤ –º–µ—Å—è—Ü?
- –ö–∞–∫–∏–µ —Ä–∞–∑–¥–µ–ª—ã —á–∞—Å—Ç–æ –º–µ–Ω—è—é—Ç—Å—è?
- –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è?
- –¢—Ä–µ–Ω–¥—ã: –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∂–µ—Å—Ç—á–µ?

### 5.4 Semantic Versioning
- Automatic versioning: CRITICAL, MAJOR, MINOR
- "v1.0 ‚Üí v1.1" –≤–º–µ—Å—Ç–æ "contract_v1_final_v2.pdf"
- Semantic version bumping rules

### 5.5 Integration Layer
- Email alerts: "Important changes in your contracts"
- Slack notifications: post changes to channel
- Webhook –¥–ª—è custom integrations
- Calendar export (iCal, Google Calendar) for key dates

### 5.6 Comparison History & Bookmarks
- Save comparisons –¥–ª—è later reference
- Bookmark –≤–∞–∂–Ω—ã–µ changes
- Create comparison templates –¥–ª—è —á–∞—Å—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

---

## 6. TECHNICAL ARCHITECTURE

### 6.1 Tech Stack

**Frontend:**
- React 18 + TypeScript
- State management: Zustand
- Styling: Tailwind CSS + ShadcnUI
- PDF viewer: react-pdf + custom annotations
- Diff viewer: custom React component (–¥–ª—è timeline, semantic diff)
- Timeline: custom D3.js –∏–ª–∏ Recharts
- Real-time: Socket.io client
- Forms: React Hook Form + Zod

**Backend:**
- Framework: FastAPI (Python 3.11+)
- ORM: SQLAlchemy + Alembic
- Database: PostgreSQL 15+ —Å pgvector –¥–ª—è embeddings
- Cache: Redis (–¥–ª—è –∫–µ—à–∞ –¥–∏—Ñ—Ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
- Message queue: Celery + Redis (async processing)
- Document processing:
  - OCR: Chandra (custom Ubuntu svc)
  - LLM: GPT-20B-oss (local, Ubuntu)
  - Embeddings: sentence-transformers (local, fast)
  - Text processing: difflib, Levenshtein
- Storage: S3-compatible (MinIO or AWS S3)

**DevOps:**
- Containerization: Docker + Docker Compose
- CI/CD: GitHub Actions
- Monitoring: Prometheus + Grafana
- Logging: structured logs to file or ELK
- Deployment: Ubuntu 22.04 LTS

### 6.2 Multi-Tenancy Architecture

**Data Isolation:**
- Row-level security (RLS) –≤ PostgreSQL
- JWT tokens —Å–æ–¥–µ—Ä–∂–∞—Ç tenant_id
- Middleware –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ tenant

**Database Schema (Core):**

```sql
-- Tenants
CREATE TABLE tenants (
  id UUID PRIMARY KEY,
  name VARCHAR(255),
  created_at TIMESTAMP,
  subscription_tier ENUM('FREE', 'PRO', 'ENTERPRISE')
);

-- Documents
CREATE TABLE documents (
  id UUID PRIMARY KEY,
  tenant_id UUID REFERENCES tenants(id),
  name VARCHAR(255),
  description TEXT,
  file_path VARCHAR(512),
  file_size INTEGER,
  page_count INTEGER,
  uploaded_by UUID REFERENCES users(id),
  uploaded_at TIMESTAMP,
  status ENUM('DRAFT', 'PROCESSING', 'READY', 'ERROR'),
  content_hash VARCHAR(256),
  extracted_text TEXT,
  embeddings VECTOR(1536)
);

-- Versions (same document, different versions)
CREATE TABLE document_versions (
  id UUID PRIMARY KEY,
  document_id UUID REFERENCES documents(id),
  version_number INTEGER,
  content TEXT,
  created_by UUID REFERENCES users(id),
  created_at TIMESTAMP,
  parent_version_id UUID REFERENCES document_versions(id)
);

-- Comparisons (cached diff results)
CREATE TABLE document_comparisons (
  id UUID PRIMARY KEY,
  tenant_id UUID REFERENCES tenants(id),
  version1_id UUID REFERENCES document_versions(id),
  version2_id UUID REFERENCES document_versions(id),
  comparison_mode VARCHAR(50),
  result JSONB,
  created_at TIMESTAMP,
  created_by UUID REFERENCES users(id)
);

-- Merges
CREATE TABLE document_merges (
  id UUID PRIMARY KEY,
  tenant_id UUID REFERENCES tenants(id),
  source_version_ids UUID[],
  merge_strategy VARCHAR(50),
  status ENUM('IN_PROGRESS', 'COMPLETED', 'FAILED'),
  result_version_id UUID REFERENCES document_versions(id),
  conflicts_count INTEGER,
  created_at TIMESTAMP
);

-- Extracted entities
CREATE TABLE extracted_entities (
  id UUID PRIMARY KEY,
  document_version_id UUID REFERENCES document_versions(id),
  entity_type VARCHAR(100),
  entity_data JSONB,
  confidence FLOAT,
  extracted_at TIMESTAMP
);

-- Risk assessments
CREATE TABLE risk_assessments (
  id UUID PRIMARY KEY,
  document_version_id UUID REFERENCES document_versions(id),
  risk_dimension VARCHAR(100),
  risk_type VARCHAR(100),
  risk_score INTEGER,
  risk_level ENUM('GREEN', 'YELLOW', 'RED'),
  description TEXT,
  assessed_at TIMESTAMP
);

-- Audit logs
CREATE TABLE audit_logs (
  id UUID PRIMARY KEY,
  tenant_id UUID REFERENCES tenants(id),
  user_id UUID REFERENCES users(id),
  resource_type VARCHAR(100),
  resource_id UUID,
  action VARCHAR(100),
  created_at TIMESTAMP
);
```

### 6.3 API Structure

```
/api/v1/
‚îú‚îÄ‚îÄ /auth/
‚îÇ   ‚îú‚îÄ‚îÄ POST /login
‚îÇ   ‚îú‚îÄ‚îÄ POST /register
‚îÇ   ‚îî‚îÄ‚îÄ POST /refresh-token
‚îú‚îÄ‚îÄ /documents/
‚îÇ   ‚îú‚îÄ‚îÄ POST /upload
‚îÇ   ‚îú‚îÄ‚îÄ POST /batch-upload
‚îÇ   ‚îú‚îÄ‚îÄ GET /
‚îÇ   ‚îú‚îÄ‚îÄ GET /{id}
‚îÇ   ‚îú‚îÄ‚îÄ DELETE /{id}
‚îÇ   ‚îú‚îÄ‚îÄ PUT /{id}/archive
‚îÇ   ‚îú‚îÄ‚îÄ GET /search
‚îÇ   ‚îú‚îÄ‚îÄ GET /{id}/versions
‚îÇ   ‚îú‚îÄ‚îÄ GET /{id}/timeline
‚îÇ   ‚îî‚îÄ‚îÄ WebSocket /stream/{id}
‚îú‚îÄ‚îÄ /compare/
‚îÇ   ‚îú‚îÄ‚îÄ POST /{id1}/vs/{id2}
‚îÇ   ‚îÇ   Query: mode=line-by-line|semantic|impact|clause|legal|timeline
‚îÇ   ‚îú‚îÄ‚îÄ GET /history
‚îÇ   ‚îú‚îÄ‚îÄ POST /save-bookmark
‚îÇ   ‚îî‚îÄ‚îÄ GET /bookmarks
‚îú‚îÄ‚îÄ /merge/
‚îÇ   ‚îú‚îÄ‚îÄ POST /
‚îÇ   ‚îÇ   Body: { document_ids: [...], merge_strategy: "..." }
‚îÇ   ‚îú‚îÄ‚îÄ GET /{id}/status
‚îÇ   ‚îú‚îÄ‚îÄ POST /{id}/resolve-conflict
‚îÇ   ‚îú‚îÄ‚îÄ POST /{id}/finalize
‚îÇ   ‚îî‚îÄ‚îÄ GET /{id}/conflicts
‚îú‚îÄ‚îÄ /extract/
‚îÇ   ‚îú‚îÄ‚îÄ GET /documents/{id}
‚îÇ   ‚îú‚îÄ‚îÄ PUT /documents/{id}/{entity_type}/{entity_id}
‚îÇ   ‚îî‚îÄ‚îÄ GET /documents/{id}/export?format=json|csv|ical|pdf
‚îú‚îÄ‚îÄ /risk/
‚îÇ   ‚îú‚îÄ‚îÄ GET /documents/{id}
‚îÇ   ‚îú‚îÄ‚îÄ GET /compare/{id1}/{id2}
‚îÇ   ‚îî‚îÄ‚îÄ POST /acknowledge
‚îî‚îÄ‚îÄ /admin/
    ‚îú‚îÄ‚îÄ GET /users
    ‚îú‚îÄ‚îÄ GET /audit-logs
    ‚îî‚îÄ‚îÄ GET /analytics
```

### 6.4 Processing Pipeline

```
[Upload PDF]
    ‚Üì
[OCR via Chandra]
    ‚Üì
[Extract raw text]
    ‚Üì
[Generate embeddings via sentence-transformers]
    ‚Üì
[LLM entity extraction + risk analysis] (async via Celery)
    ‚Üì
[Store in DB + S3]
    ‚Üì
[Ready for comparison]
```

---

## 7. USER FLOWS

### Flow 1: Quick Comparison (2 contracts)

```
1. User opens Documents page
2. Selects contract_v1.pdf and contract_v2.pdf
3. Clicks "Compare"
4. System shows comparison mode selector:
   - Line-by-Line (classic diff)
   - Semantic (what changed in meaning)
   - Impact (financial/risk changes)
   - Clause (structural analysis)
   - Legal (for lawyers)
   - Timeline (all versions history)
5. User selects "Semantic"
6. System loads beautiful diff view:
   - Original vs Modified side-by-side
   - Changes grouped by type (DEFINITION_CHANGE, NUMERICAL_CHANGE, etc.)
   - Color-coded severity (üî¥ CRITICAL, üü° MAJOR, üü¢ MINOR)
7. User can click each change to see AI explanation
8. User scrolls through or uses navigation
```

### Flow 2: Merge Multiple Versions

```
1. User has 5 versions of same contract
2. Uploads all 5 to same "Contract Negotiation" folder
3. System auto-detects: "These look like versions of same document"
4. User clicks "Merge" button
5. Selects merge strategy: "CONSENSUS" (majority wins)
6. System processes:
   - Compares all 5 versions
   - Finds common blocks (apply to merged automatically)
   - Finds conflicts (3 blocks where versions differ)
7. UI shows conflict resolution wizard:
   - Conflict 1 of 3: Payment Terms
   - Shows 3 options (from 3 different versions)
   - User selects winning option
8. Repeats for conflicts 2, 3
9. Preview merged result
10. Click "Create Merged Version"
11. New document created, timeline updated
```

### Flow 3: Timeline Deep Dive

```
1. User opens "Contracts by Project" folder
2. Selects one contract (which has 8 versions over 2 months)
3. Clicks "View Timeline"
4. Beautiful vertical timeline appears:
   - v1.0 (Jan 5) - Ivan
   - v1.1 (Jan 7) - Maria
   - v1.2 (Jan 10) - Finance (merged from 2 branches)
   - v2.0 (Jan 20) - Legal rewrite
   - v2.1 (Jan 22) - Final approved
5. User hovers over v1.2 ‚Üí sees popup:
   - "Merged version"
   - "15 changes, 3 CRITICAL"
   - Key changes: "Payment 90‚Üí30 days, Sum 100k‚Üí150k"
6. User clicks v1.2 ‚Üí opens detailed view
7. Can see exact diff between v1.1 and v1.2
8. Or can drag to compare v1.0 vs v2.1 directly
```

### Flow 4: Risk Analysis

```
1. User uploads new contract
2. System async processes:
   - OCR + extraction
   - Entity extraction
   - Risk analysis
3. After processing, user opens document
4. See "Risk Summary" card:
   - Overall score: 72/100 (YELLOW)
   - 3 RED risks, 5 YELLOW risks
5. User clicks each risk to see:
   - What it is
   - Why it matters
   - How to mitigate
6. User compares two versions:
   - v1.0: risk score 45 (GREEN)
   - v1.1: risk score 72 (YELLOW)
   - "Risk increased by 27 points"
   - Show which changes caused the risk increase
```

---

## 8. NON-FUNCTIONAL REQUIREMENTS

### 8.1 Performance
- [ ] Document upload: < 10s for typical 10-page PDF
- [ ] Diff generation (semantic mode): < 5s for comparing 2 documents
- [ ] Timeline generation: < 2s even for 20 versions
- [ ] Search: < 2s for full-text search
- [ ] API response: < 200ms for typical queries
- [ ] Entity extraction: < 30s per document (async)

### 8.2 Scalability
- [ ] Support 10+ tenants initially (roadmap: 1000+)
- [ ] Support 100+ users per tenant
- [ ] Support 10,000 documents per tenant
- [ ] Horizontal scaling: stateless backend
- [ ] Database: read replicas for scaling reads

### 8.3 Security
- [ ] Authentication: OAuth 2.0 + JWT
- [ ] Encryption: TLS 1.3
- [ ] Row-level security (RLS) in PostgreSQL
- [ ] Audit logging: all actions logged
- [ ] GDPR compliance: data retention, right to deletion

### 8.4 Availability
- [ ] Uptime: 99% SLA
- [ ] Backup: daily automatic
- [ ] Disaster recovery: RTO 4h, RPO 1h

### 8.5 Reliability
- [ ] Graceful error handling
- [ ] Retry logic: exponential backoff
- [ ] Circuit breaker for external services

---

## 9. ACCEPTANCE CRITERIA (MVP)

- [ ] Document upload + OCR processing
- [ ] All 6 comparison modes functional (Line-by-Line, Semantic, Impact, Clause, Legal, Timeline)
- [ ] Beautiful timeline visualization with interactivity
- [ ] 3-way merge algorithm working
- [ ] Multi-way merge with conflict detection
- [ ] Semantic diff with AI summaries
- [ ] Risk analysis for financial/legal/temporal dimensions
- [ ] Entity extraction for key contract fields
- [ ] Multi-tenancy with data isolation
- [ ] Authentication (JWT)
- [ ] API documented (Swagger/OpenAPI)
- [ ] Performance targets met
- [ ] Unit tests: 70%+ coverage
- [ ] E2E tests: critical flows

---

## 10. ROADMAP

### Q1 2026 (Current)
- ‚úÖ MVP: all 6 comparison modes
- ‚úÖ Beautiful timeline
- ‚úÖ Merge algorithms
- ‚úÖ Risk analysis
- ‚öôÔ∏è Beta testing

### Q2 2026
- Clause library & compliance checking
- Document analytics dashboard
- Semantic versioning
- Performance optimization

### Q3 2026
- Integration layer (Slack, Email, Webhooks)
- Advanced comparison templates
- Repository analytics

### Q4 2026
- Enterprise features
- Advanced security (MFA, SSO)

---

## 11. SUCCESS METRICS (KPIs)

1. **Time to Understand Changes**
   - Baseline: 30 minutes per contract
   - Target: 5 minutes
   - Measurement: user task completion time

2. **Comparison Accuracy**
   - Target: 95% of changes correctly identified
   - Measurement: user feedback accuracy rating

3. **Merge Success Rate**
   - Target: 80% without manual intervention
   - Measurement: auto-merged / total merges

4. **System Performance**
   - Semantic diff: < 5s
   - Timeline: < 2s
   - Uptime: 99%

---

## 12. GLOSSARY

| –¢–µ—Ä–º–∏–Ω | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|---------|
| **Diff** | –†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –¥–≤—É–º—è –≤–µ—Ä—Å–∏—è–º–∏ |
| **Semantic diff** | –£–º–Ω—ã–π diff, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–Ω–∏–º–∞–µ—Ç —Å–º—ã—Å–ª |
| **Impact Analysis** | –ê–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ –±–∏–∑–Ω–µ—Å |
| **Merge** | –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π |
| **Timeline** | –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| **Risk Score** | –ß–∏—Å–ª–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞ (0-100) |
| **Entity Extraction** | –ü–∞—Ä—Å–∏–Ω–≥ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| **Tenant** | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è/–∫–æ–º–ø–∞–Ω–∏—è |

---

**End of PRD**

–£—Å–ø–µ—Ö–æ–≤! üöÄ
